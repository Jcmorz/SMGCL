[06/17 14:43:33][INFO] WBNCF:   41: terminal cmd: python E:/高子皓/研究生/我的工作/协同对比自监督学习图卷积网络用于药物-疾病预测/CSL-main/main.py
[06/17 14:43:33][INFO] WBNCF:   42: log file: result\global-10-fold\Cdataset\CSL\2022-06-17 14-43-33.log
[06/17 14:43:33][INFO] WBNCF:  131: {'alpha': 0.5,
 'comment': 'result',
 'dataset_name': 'Cdataset',
 'dataset_type': None,
 'debug': True,
 'disease_feature_topk': 20,
 'disease_idx': None,
 'disease_neighbor_num': 4,
 'dropout': 0.4,
 'drug_feature_topk': 20,
 'drug_idx': None,
 'drug_neighbor_num': 4,
 'embedding_dim': 128,
 'epochs': 49,
 'gamma': 2.0,
 'get_dropout': 0.0,
 'global_test_all_zero': False,
 'gpus': 0,
 'hidden_dims': (128, 64),
 'lamda': 0.8,
 'log_dir': 'result\\global-10-fold\\Cdataset\\CSL',
 'loss_fn': 'focal',
 'lr': 0.0005,
 'model': 'CSL',
 'n_disease': 409,
 'n_drug': 663,
 'n_splits': 10,
 'negative_slope': 0.01,
 'neighbor_embedding_dim': 64,
 'pos_weight': 106.09597156398104,
 'profiler': False,
 'seed': 918,
 'separate': False,
 'size_u': 663,
 'size_v': 409,
 'split_mode': 'global',
 'time_stamp': 'Fri Jun 17 14:43:33 2022',
 'train_fill_unknown': True}
[06/17 14:43:33][INFO] WBNCF:  165: CSL(
  (drug_embedding_compress): Linear(in_features=663, out_features=128, bias=False)
  (disease_embedding_compress): Linear(in_features=409, out_features=128, bias=False)
  (bgcn_encoder1): NeighborEmbedding1(
    (shutcut): Linear(in_features=128, out_features=64, bias=True)
    (bgnn): BGCNA(128, 64)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (bgcn_encoder2): NeighborEmbedding2(
    (shutcut): Linear(in_features=128, out_features=64, bias=True)
    (bgnn): BGCNA(128, 64)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (drug_att_encoder): GraphAttentionLayer (663 -> 64)
  (disease_att_encoder): GraphAttentionLayer (409 -> 64)
  (interaction_encoder): InteractionEmbedding(
    (drug_project): Linear(in_features=663, out_features=128, bias=False)
    (disease_project): Linear(in_features=409, out_features=128, bias=False)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (decoder): InteractionDecoder(
    (decoder): Sequential(
      (0): Linear(in_features=256, out_features=128, bias=True)
      (1): ReLU(inplace=True)
      (2): Dropout(p=0.4, inplace=False)
      (3): Linear(in_features=128, out_features=64, bias=True)
      (4): ReLU(inplace=True)
      (5): Dropout(p=0.4, inplace=False)
      (6): Linear(in_features=64, out_features=1, bias=True)
      (7): Sigmoid()
    )
  )
)
[06/17 14:43:33][INFO] WBNCF:  167: begin train fold 0/10
[06/17 16:28:10][INFO] WBNCF:  169: end train fold 0/10
[06/17 16:28:12][INFO] WBNCF:   77: eval time cost: 0.5936634540557861
[06/17 16:28:12][INFO] WBNCF:   85: save time cost: 0.04689526557922363
[06/17 16:28:12][INFO] WBNCF:  180: 0/10 folds: {'aupr': 0.6152332147169933, 'auroc': 0.9461102995314984, 'lagcn_aupr': 0.5017741159850567, 'lagcn_auc': 0.9396596915489399, 'lagcn_f1_score': 0.56162244, 'lagcn_accuracy': 0.98963785, 'lagcn_recall': 0.70866144, 'lagcn_specificity': 0.99229455, 'lagcn_precision': 0.4651163}
[06/17 16:28:12][INFO] WBNCF:  181: 0/10 folds time cost: 6279.346008062363
[06/17 16:28:12][INFO] WBNCF:  188: total time cost:6279.346008062363
[06/17 16:28:14][INFO] WBNCF:  203: final Cdataset-global-10-fold-auroc:0.9461102995314984-aupr:0.6152332147169933
[06/17 16:28:14][INFO] WBNCF:  219: final results: {'aupr': 0.6152332147169933, 'auroc': 0.9461102995314984, 'lagcn_aupr': None, 'lagcn_auc': None, 'lagcn_f1_score': None, 'lagcn_accuracy': None, 'lagcn_recall': None, 'lagcn_specificity': None, 'lagcn_precision': None}
