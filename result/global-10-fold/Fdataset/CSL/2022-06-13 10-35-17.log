[06/13 10:35:17][INFO] WBNCF:   41: terminal cmd: python E:/高子皓/研究生/我的工作/协同对比自监督学习图卷积网络用于药物-疾病预测/CSL-main/main.py
[06/13 10:35:17][INFO] WBNCF:   42: log file: result\global-10-fold\Fdataset\CSL\2022-06-13 10-35-17.log
[06/13 10:35:17][INFO] WBNCF:  131: {'alpha': 0.5,
 'comment': 'result',
 'dataset_name': 'Fdataset',
 'dataset_type': None,
 'debug': False,
 'disease_feature_topk': 20,
 'disease_idx': None,
 'disease_neighbor_num': 4,
 'dropout': 0.4,
 'drug_feature_topk': 20,
 'drug_idx': None,
 'drug_neighbor_num': 4,
 'embedding_dim': 16,
 'epochs': 64,
 'gamma': 2.0,
 'get_dropout': 0.0,
 'global_test_all_zero': False,
 'gpus': 0,
 'hidden_dims': (16, 8),
 'lamda': 0.8,
 'log_dir': 'result\\global-10-fold\\Fdataset\\CSL',
 'loss_fn': 'focal',
 'lr': 0.0005,
 'model': 'CSL',
 'n_disease': 313,
 'n_drug': 593,
 'n_splits': 10,
 'negative_slope': 0.01,
 'neighbor_embedding_dim': 8,
 'pos_weight': 95.02121055354371,
 'profiler': False,
 'seed': 918,
 'separate': False,
 'size_u': 593,
 'size_v': 313,
 'split_mode': 'global',
 'time_stamp': 'Mon Jun 13 10:35:17 2022',
 'train_fill_unknown': True}
[06/13 10:35:17][INFO] WBNCF:  165: CSL(
  (drug_embedding_compress): Linear(in_features=593, out_features=16, bias=False)
  (disease_embedding_compress): Linear(in_features=313, out_features=16, bias=False)
  (bgcn_encoder): NeighborEmbedding(
    (shutcut): Linear(in_features=16, out_features=8, bias=True)
    (bgnn): BGCNA(16, 8)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (drug_bgcn_encoder): NeighborEmbedding(
    (shutcut): Linear(in_features=593, out_features=8, bias=True)
    (bgnn): BGCNA(593, 8)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (disease_bgcn_encoder): NeighborEmbedding(
    (shutcut): Linear(in_features=313, out_features=8, bias=True)
    (bgnn): BGCNA(313, 8)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (drug_att_encoder): GraphAttentionLayer (593 -> 8)
  (disease_att_encoder): GraphAttentionLayer (313 -> 8)
  (interaction_encoder): InteractionEmbedding(
    (drug_project): Linear(in_features=593, out_features=16, bias=False)
    (disease_project): Linear(in_features=313, out_features=16, bias=False)
    (dropout): Dropout(p=0.4, inplace=False)
  )
  (decoder): InteractionDecoder(
    (decoder): Sequential(
      (0): Linear(in_features=32, out_features=16, bias=True)
      (1): ReLU(inplace=True)
      (2): Dropout(p=0.4, inplace=False)
      (3): Linear(in_features=16, out_features=8, bias=True)
      (4): ReLU(inplace=True)
      (5): Dropout(p=0.4, inplace=False)
      (6): Linear(in_features=8, out_features=1, bias=True)
      (7): Sigmoid()
    )
  )
)
[06/13 10:35:17][INFO] WBNCF:  167: begin train fold 0/10
[06/13 10:38:54][INFO] WBNCF:  169: end train fold 0/10
[06/13 10:38:55][INFO] WBNCF:   77: eval time cost: 0.5779814720153809
[06/13 10:38:55][INFO] WBNCF:   85: save time cost: 0.0
[06/13 10:38:55][INFO] WBNCF:  180: 0/10 folds: {'aupr': 0.16994467518786746, 'auroc': 0.8278168666259564, 'lagcn_aupr': 0.18430529251204616, 'lagcn_auc': 0.8278098596683352, 'lagcn_f1_score': 0.25373134, 'lagcn_accuracy': 0.9892253, 'lagcn_recall': 0.17525773, 'lagcn_specificity': 0.9978223, 'lagcn_precision': 0.45945945}
[06/13 10:38:55][INFO] WBNCF:  181: 0/10 folds time cost: 218.63052415847778
[06/13 10:38:55][INFO] WBNCF:  167: begin train fold 1/10
[06/13 10:42:36][INFO] WBNCF:  169: end train fold 1/10
[06/13 10:42:37][INFO] WBNCF:   77: eval time cost: 0.6266777515411377
[06/13 10:42:37][INFO] WBNCF:   85: save time cost: 0.0
[06/13 10:42:37][INFO] WBNCF:  180: 1/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 10:42:37][INFO] WBNCF:  181: 1/10 folds time cost: 221.6480209827423
[06/13 10:42:37][INFO] WBNCF:  167: begin train fold 2/10
[06/13 10:45:55][INFO] WBNCF:  169: end train fold 2/10
[06/13 10:45:56][INFO] WBNCF:   77: eval time cost: 0.5296123027801514
[06/13 10:45:56][INFO] WBNCF:   85: save time cost: 0.0028676986694335938
[06/13 10:45:56][INFO] WBNCF:  180: 2/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 10:45:56][INFO] WBNCF:  181: 2/10 folds time cost: 198.75312066078186
[06/13 10:45:56][INFO] WBNCF:  167: begin train fold 3/10
[06/13 10:49:19][INFO] WBNCF:  169: end train fold 3/10
[06/13 10:49:20][INFO] WBNCF:   77: eval time cost: 0.54758620262146
[06/13 10:49:20][INFO] WBNCF:   85: save time cost: 0.0
[06/13 10:49:20][INFO] WBNCF:  180: 3/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 10:49:20][INFO] WBNCF:  181: 3/10 folds time cost: 204.0958070755005
[06/13 10:49:20][INFO] WBNCF:  167: begin train fold 4/10
[06/13 10:52:57][INFO] WBNCF:  169: end train fold 4/10
[06/13 10:52:58][INFO] WBNCF:   77: eval time cost: 0.5340700149536133
[06/13 10:52:58][INFO] WBNCF:   85: save time cost: 0.0017843246459960938
[06/13 10:52:58][INFO] WBNCF:  180: 4/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 10:52:58][INFO] WBNCF:  181: 4/10 folds time cost: 218.44422578811646
[06/13 10:52:58][INFO] WBNCF:  167: begin train fold 5/10
[06/13 10:56:32][INFO] WBNCF:  169: end train fold 5/10
[06/13 10:56:33][INFO] WBNCF:   77: eval time cost: 0.5322575569152832
[06/13 10:56:33][INFO] WBNCF:   85: save time cost: 0.015621423721313477
[06/13 10:56:33][INFO] WBNCF:  180: 5/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 10:56:33][INFO] WBNCF:  181: 5/10 folds time cost: 214.9263937473297
[06/13 10:56:33][INFO] WBNCF:  167: begin train fold 6/10
[06/13 11:00:11][INFO] WBNCF:  169: end train fold 6/10
[06/13 11:00:11][INFO] WBNCF:   77: eval time cost: 0.5623950958251953
[06/13 11:00:11][INFO] WBNCF:   85: save time cost: 0.0
[06/13 11:00:11][INFO] WBNCF:  180: 6/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 11:00:11][INFO] WBNCF:  181: 6/10 folds time cost: 218.3058807849884
[06/13 11:00:11][INFO] WBNCF:  167: begin train fold 7/10
[06/13 11:04:02][INFO] WBNCF:  169: end train fold 7/10
[06/13 11:04:03][INFO] WBNCF:   77: eval time cost: 0.5707733631134033
[06/13 11:04:03][INFO] WBNCF:   85: save time cost: 0.003957033157348633
[06/13 11:04:03][INFO] WBNCF:  180: 7/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 11:04:03][INFO] WBNCF:  181: 7/10 folds time cost: 231.43529796600342
[06/13 11:04:03][INFO] WBNCF:  167: begin train fold 8/10
[06/13 11:07:30][INFO] WBNCF:  169: end train fold 8/10
[06/13 11:07:31][INFO] WBNCF:   77: eval time cost: 0.5431416034698486
[06/13 11:07:31][INFO] WBNCF:   85: save time cost: 0.0
[06/13 11:07:31][INFO] WBNCF:  180: 8/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 11:07:31][INFO] WBNCF:  181: 8/10 folds time cost: 207.76697063446045
[06/13 11:07:31][INFO] WBNCF:  167: begin train fold 9/10
[06/13 11:11:09][INFO] WBNCF:  169: end train fold 9/10
[06/13 11:11:09][INFO] WBNCF:   77: eval time cost: 0.5467488765716553
[06/13 11:11:09][INFO] WBNCF:   85: save time cost: 0.0
[06/13 11:11:09][INFO] WBNCF:  180: 9/10 folds: {'aupr': 0.24169461281306545, 'auroc': 0.8569826165630949, 'lagcn_aupr': 0.24137910730501108, 'lagcn_auc': 0.8569579250672568, 'lagcn_f1_score': 0.29411766, 'lagcn_accuracy': 0.9883633, 'lagcn_recall': 0.23195876, 'lagcn_specificity': 0.9963524, 'lagcn_precision': 0.4017857}
[06/13 11:11:09][INFO] WBNCF:  181: 9/10 folds time cost: 218.71324753761292
[06/13 11:11:09][INFO] WBNCF:  188: total time cost:2152.719489336014
[06/13 11:11:10][INFO] WBNCF:  203: final Fdataset-global-10-fold-auroc:0.8527001393615969-aupr:0.23338557534052645
[06/13 11:11:10][INFO] WBNCF:  219: final results: {'aupr': 0.23338557534052645, 'auroc': 0.8527001393615969, 'lagcn_aupr': None, 'lagcn_auc': None, 'lagcn_f1_score': None, 'lagcn_accuracy': None, 'lagcn_recall': None, 'lagcn_specificity': None, 'lagcn_precision': None}
